<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" integrity="sha512-Fo3rlrZj/k7ujTnHg4CGR2D7kSs0v4LLanw2qksYuRlEzO+tcaEPQogQ0KaoGN26/zrn20ImR1DfuLWnOo7aBA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel='stylesheet' href='options\style.css'>
    <link rel='icon' href = 'options\icon.jpg'>
    <script src='options\option.js'></script>
</head>
<body>
    <div class='container'>
        <div id='nav' class='nav'>   
            <span class='nav-title'>VIT VANG TEAM</span>
            <div class='nav-list'>
                <li id = 'member' class='nav-item break'>Member</li>
                <li id = 'tools' class='nav-item break'>Tools</li>
                <li id = 'auto' class='nav-item break'>Automatic Process</li>
                <li id = 'source' class='nav-item'>Source Code</li>
            </div>
        </div>
        
        <div class = 'main'>
            <div class='main-container'>
                <div class='img_content'>
                    <span class='welcome'>Welcome To Our Website</span>
                    <normal>Project of VitVang-Team</normal>
                </div>
                <div class="box_container">
                    <div class="box">Chào thầy cô, đây là trang web chứa những thông tin về đồ án 2 của team Vịt Vàng. Mọi thông tin như thành viên, công cụ sử dụng, sản phẩm đồ án và source code đều được lưu trữ trên thanh điều hướng.</div>
                </div>
            </div>
        </div>
        
        <div class = 'main'>
            <link rel = 'stylesheet' href = 'options/profile.css'>
            <div class="profile-main">
                <div class='profile-container'>
                    <div class="profile active">
                        <img class='profile-img' src='member/1.jpg'>
                        <p class='profile-info'>Trần Mai Chí Tâm</p>
                        <p class='profile-info'>21280047 <br>(Scrum Master)</p>
                    </div>
                    <div class="profile">
                        <img class='profile-img' src='member/3.jpg'>
                        <p class='profile-info'>Nguyễn Thu Hiền</p>
                        <p class='profile-info'>21280012 <br>(Tester)</p>
                        
                    </div>
                    <div class="profile">
                        <img class='profile-img' src='member/2.jpeg'>
                        <p class='profile-info'>Nguyễn Đông Hải</p>
                        <p class='profile-info'>21280015 <br>(Developer)</p>
                    </div>
                    <div class="profile">
                        <img class='profile-img' src='member/4.2.jpg'>
                        <p class='profile-info'>Trần Minh Hiển</p>
                        <p class='profile-info'>21280016 <br>(Developer)</p>
                    </div>
                    <div class='button-profile'>
                        <button  class='button-profile left'><i class="fas fa-arrow-left"></i></button>
                        <button  class='button-profile right'><i class="fas fa-arrow-right"></i></button>
                    </div>
                    <script src='options/profile.js'></script>
                </div>
            </div>
        </div>       
         
        <div class = 'main'>
            <link rel='stylesheet' href='options\tools.css'>
            <div class="tools-main">
                <div class="tools-container">
                    <span>Giới thiệu sơ lược các công cụ được sử dụng trong quá trình tự động</span>
                    <div class="tool-items">
                        <p>1. Microsoft SQL Sever</p>
                        <img class='tools-img' src='https://teky.edu.vn/blog/wp-content/uploads/2021/07/cau-lenh-sql.jpg'>
                        <p id = 'tools-text'>
                            _SQL server hay còn được gọi là Microsoft SQL Server, nó từ viết tắt của MS SQL Server. Đây chính là một loại phần mềm đã được phát triển bởi Microsoft và nó được sử dụng để có thể dễ dàng lưu trữ cho những dữ liệu dựa theo tiêu chuẩn RDBMS.
                        </p>
                        <p id='tools-text'>
                            <br>
                            _Đây là công cụ chủ yếu cho việc chia nhỏ dữ liệu và sử dụng để làm sạch dữ liệu cũng như lấy truy vấn cho người dùng
                        </p>
                        <p id='tools-text'>
                            <br>
                            _Microsoft tiếp thị ít nhất một chục phiên bản Microsoft SQL Server khác nhau, nhắm vào các đối tượng khác nhau và cho khối lượng công việc khác nhau, từ các ứng dụng máy đơn nhỏ đến các ứng dụng Internet lớn có nhiều người dùng đồng thời.
                        </p>
                        <img class='tools-img' src='https://docs.microsoft.com/en-us/sql/ssms/f1-help/media/database-engine-query-editor-sql-server-management-studio/new-query.png?view=sql-server-ver15'>
                        <p id='tools-text' style = 'text-align: center;'>Giao diện thường thấy ở SQL</p>
                        <a style = 'color:white;' href='https://www.thegioididong.com/game-app/huong-dan-cai-dat-sql-server-2019-cuc-don-gian-chi-1312926'><br><br>Cách cài đặt</a>
                    </div>
                    <div class="tool-items">
                        <p>2. NNLT Python</p>
                        <img class='tools-img' src='https://vietnix.vn/wp-content/uploads/2021/07/python-la-gi.webp'>
                        <p id = 'tools-text'>
                            _Ngôn ngữ lập trình Python là một trong những ngôn ngữ được sử dụng phổ biến nhất trong giới lập trình, nó chứa đựng nhiều thư viện giúp cho người sử dụng dễ dàng truy xuất lệnh trong ngôn ngữ mà không cần phải xây dựng trước một cấu trúc nào cả.<br><br>
                            _Trong quá trình tự động của đồ án, nhóm đã sử dụng Python để code chia, tạo cơ sở dữ liệu và xử lí truy vấn cho dữ liệu.
                        </p>
                        <img class='tools-img' src='https://www.udacity.com/blog/wp-content/uploads/2020/11/Hello-World_Blog-scaled.jpeg'> 
                        <p id='tools-text' style='text-align: center;'>
                            cấu trúc lệnh đơn giản của python
                        </p>
                        <a style = 'color:white;' href='https://quantrimang.com/cach-cai-dat-python-tren-windows-macos-linux-140625'><br><br>Cách cài đặt</a>
                    </div>
                    <div class="tool-items">
                        <p>3. OpenSSL</p>
                        <img class='tools-img' src='https://wiki.tino.org/wp-content/uploads/2021/09/word-image-1158.png'>
                        <p id='tools-text'>_OpenSSL là một thư viện phần mềm cho các ứng dụng bảo mật truyền thông qua mạng máy tính chống nghe trộm hoặc cần phải xác định phe truyền thông ở bên đầu kia. Nó được sử dụng rộng rãi trong các máy chủ web internet, phục vụ phần lớn tất cả các trang web.</p>
                        <br>
                        <p id='tools-text'>
                            _OpenSSL bao gồm phần mềm nguồn mở cho việc triển khai các giao thức mạng và mã hóa khác nhau như SSL và TLS. Thư viện gốc được viết bằng ngôn ngữ lập trình C, có sẵn những phần mềm cho phép sử dụng thư viện OpenSSL trong nhiều ngôn ngữ, cung cấp các chức năng mật mã tổng quát để mã hóa và giải mã. OpenSSL cũng được sử dụng từ dòng lệnh để yêu cầu, tạo và quản lý các chứng thực số.
                        </p>
                        <br>
                        <p id='tools-text'>
                            _Sử dụng OpenSSL để tạo định dạng mã hóa RSA, cho ra 2 cặp key (privatekey và publickey) để mã hóa và giải mã dữ liệu.
                        </p>
                        <a style = 'color:white;' href='https://stackjava.com/ssl/huong-dan-cai-dat-openssl-tren-windows-10.html'><br><br>Cách cài đặt</a>
                    </div>
                    <div class="tool-items">
                        <p>4. RoboTask</p>
                        <img class='tools-img' src='https://couponhd.com/wp-content/uploads/2018/12/RoboTask-Discount-Coupon.jpg'>
                        <p id='tools-text'>_Thay vì sử dụng Scheduled Task, ta co thể sử dụng một phần mềm đặt lịch tương tự như RoboTask<br><br>_Ở đây RoboTask cho phép ta điều chỉnh được nhiều hướng trigger hơn
                        , Ví dụ như theo dõi thư mục và các chức năng mới cho phép ta xử lí thao tác nhiều file và dễ dàng hơn.</p>
                        <img class='tools-img' src='http://www.robotask.com/screenshots/mainlite_ss.gif'>
                        <p id='tools-text' style = 'text-align: center;'>Giao diện cơ bản của RoboTask</p>
                        <p id='tools-text'><br>Tương tự như Scheduled Task ta sẽ đặt 1 hành động để kích hoạt chương trình chạy bằng cách:<br>
                        <br>B1: Chọn New Task --> Triggering Events --> Chọn hành động kích hoạt phù hợp cho quá trình tự động.<br><br>B2: Chọn Actions, ở đây ta sẽ chọn công việc thực hiện tự động sau khi máy đã nhận diện ra được quá trình kích hoạt
                         </p>
                         <br><p id='tools-text'>Chỉ với các bước như thế ta đã có thể tự động hóa 1 công việc theo sự thay đổi của mốc thời gian, dữ liệu trong kho, hoặc một hành động cụ thể nào đó tùy theo người dùng muốn.</p>
                         <a style = 'color:white;' href='https://robotask.com/'><br><br>Link Tải Phần Mềm</a>
                    </div>
                    </div>
                </div>
            </div>
        </div>        
        
        <div class = 'main active'>
            <link rel='stylesheet' href='options/auto.css'>
            <div class="process-container">
                <div class="process-item-container">
                    <div class="process-item">
                        <p>CẤU TRÚC DỮ LIỆU TỰ ĐỘNG GIỮA 2 MÁY ẢO</p>
                        <img src='img/dothi.png'>
                    </div>                
                    <div class="process-item">
                        <p>VIDEO QUÁ TRÌNH TỰ ĐỘNG XỬ LÝ DỮ LIỆU</p>
                        <video controls>
                            <source src='img/temp1_doan.mp4'>
                        </video>
                    </div>
                </div>
            </div>
        </div>

        <div class = 'main'>
            <link rel = 'stylesheet' href = 'options\source.css'>
            <div class='source-container'>
                <div class='source-container title'>SOURCE CODE</div>
                <div class='select-source'>
                    <button class='select-button'>Python</button>
                    <button class='select-button'>Batch Script</button>
                </div>
                
                <div class='source-context'>
                    <div class='source-lang'>Python</div>
                    <div class='source-context-container'>
                        <div class='source-title'>1. Chia nhỏ file:</div>
                        <pre class='text-wrap'>

                            import pyodbc
                            import pandas as pd
                            import os 
                            import numpy as np
                            connection = pyodbc.connect(
                                driver = '{ODBC Driver 17 for SQL Server}', 
                                host = 'HOST',
                                database = 'PROCESS',trusted_connection='yes'
                            )                            
                            NAME = ['Title','Author','Genre','SubGenre','Height','Publisher']
                            for NAME_TITLE in NAME:
                                sqlQuery = "select "+ NAME_TITLE + " from [PROCESS].[dbo].[Data]"
                                df = pd.read_sql(sqlQuery, con = connection)
                                df = df.fillna(np.nan).replace([np.nan],[None])
                                df.to_csv("C:\\Container\\"+NAME_TITLE+".csv",index = False)

                        </pre>
                    </div>
                    <div class='source-context-container'>
                        <div class='source-title'>2. Gộp dữ liệu:</div>
                        <pre class='text-wrap'>

                            from contextlib import nullcontext
                            import pyodbc 
                            import pandas as pd 
                            import numpy as np
                            
                            connection = pyodbc.connect(
                                driver = '{ODBC Driver 17 for SQL Server}', 
                                host = 'HOST',database = 'PROCESS',
                                trusted_connection='yes'
                            )
                            name = ['Title','Author','Genre','SubGenre','Height','Publisher']
                            ##NAME SET TABLE = DATA {}
                            cursor = connection.cursor()
                            #df = pd.read_csv("D:\Data_container\DATA.csv") #folder sharing
                            ##check --- file exits
                            direction = "DROP TABLE IF EXISTS DATA"
                            cursor.execute(direction)
                            ##update -- chu ky` khi input thay doi
                            direction = "CREATE TABLE DATA(Title nvarchar(100), Author nvarchar(100),
                            Genre nvarchar(100), SubGenre nvarchar(100),Height int, Publisher nvarchar(100))"
                            cursor.execute(direction)
                            
                            #df = df.fillna(np.nan).replace([np.nan],[None]) #thay doi gia tri rong -> NULL
                            def clean_data(df,text):
                                for i in range(0,df.shape[0]-1):
                                    pos = str(df[text][i]).find(',')
                                    if pos != -1:
                                         df[text][i] = df[text][i].replace(',','')
                                         s1 = df[text][i][0:pos]
                                         s2 = df[text][i][pos+1:len(df[text][i])]
                                         df[text][i] = s2 + ' ' + s1
                                    print(df[text][i])
                            dir = "C:\\HOST\\INPUT\\"
                            df1 = pd.read_csv(dir+name[0]+".csv")
                            clean_data(df1,name[0])
                            df2 = pd.read_csv(dir+name[1]+".csv")
                            clean_data(df2,name[1])
                            df3 = pd.read_csv(dir+name[2]+".csv")
                            clean_data(df3,name[2])
                            df4 = pd.read_csv(dir+name[3]+".csv")
                            clean_data(df4,name[3])
                            df5 = pd.read_csv(dir+name[4]+".csv")
                            clean_data(df5,name[4])
                            df6 = pd.read_csv(dir+name[5]+".csv")
                            clean_data(df6,name[5])
                            df1 = df1.fillna(np.nan).replace([np.nan],[None])
                            df2 = df2.fillna(np.nan).replace([np.nan],[None])
                            df3 = df3.fillna(np.nan).replace([np.nan],[None])
                            df4 = df4.fillna(np.nan).replace([np.nan],[None])
                            df5 = df5.fillna(np.nan).replace([np.nan],[None])
                            df6 = df6.fillna(np.nan).replace([np.nan],[None])
                            for i in range(0,211):    
                                direction = "insert into Data("+name[0]+","+name[1]+","+name[2]+","
                                +name[3]+","+name[4]+","+name[5]+") values(?,?,?,?,?,?)"
                                cursor.execute(
                                    direction,
                                    df1[name[0]][i],        
                                    df2[name[1]][i],
                                    df3[name[2]][i],
                                    df4[name[3]][i],
                                    int(df5[name[4]][i]),
                                    df6[name[5]][i]
                                )
                            
                            connection.commit()
                        </pre>
                    </div>
                    <div class='source-context-container'>
                        <div class='source-title'>3. Xuất truy vấn:</div>
                        <pre class='text-wrap'>
                            
                        import pyodbc
                        import pandas as pd
                        import os 
                        connection = pyodbc.connect(
                            driver = '{ODBC Driver 17 for SQL Server}', 
                            host = 'HOST',
                            database = 'PROCESS',trusted_connection='yes'
                        )
                        sqlQuery = "select * from [PROCESS].[dbo].[DATA]"
                        df = pd.read_sql(sqlQuery,con = connection)
                        df.to_csv("C:\\HOST\\Process\\"+"DATA_CLEAN"+".csv",index = False)

                        sqlQuery = "select genre,count(*) CountOfGenre from [PROCESS].[dbo].[DATA] group by genre"
                        df = pd.read_sql(sqlQuery, con = connection)
                        df.to_csv("C:\\HOST\\Process\\"+"DATA_AmountOfGenre"+".csv",index = False)

                        sqlQuery = "select * from [PROCESS].[dbo].[DATA] as df where df.author IS NOT NULL and df.publisher IS NOT NULL"
                        df = pd.read_sql(sqlQuery, con = connection)
                        df.to_csv("C:\\HOST\\Process\\"+"DATA_NON_NULL"+".csv",index = False)

                        sqlQuery = "select author,count(*) CountOfGenre from [PROCESS].[dbo].[DATA] group by author"
                        df = pd.read_sql(sqlQuery, con = connection)
                        df.to_csv("C:\\HOST\\Process\\"+"DATA_AmountBookOfAuthor"+".csv",index = False)

                        </pre>
                    </div>
                </div>          

                <div class='source-context'>
                    <div class='source-lang'>Batch Script</div>
                    <div class='source-context-container'>
                        <div class='source-title'>1. Tạo khóa đối xứng và mã hóa file zip:</div>
                        <pre class='text-wrap'>

                            @echo off
                            color c
                            
                            cd C:\Host\Process\
                            set /a pass=%RANDOM% * %RANDOM% * %RANDOM%
                            echo %pass%>>pass.txt
                            
                            cd C:\Program Files\7-Zip
                            7z a -p%pass% C:\Host\Process\DATA_OUT.zip C:\Host\Process\DATA_CLEAN.csv
                             C:\Host\Process\Author.csv C:\Host\Process\Title.csv C:\Host\Process\Genre.csv
                              C:\Host\Process\SubGenre.csv C:\Host\Process\Publisher.csv C:\Host\Process\Height.csv
                            
                            cd c:\Host\
                            openssl genrsa -out privatekey.pem 2048
                            openssl rsa -in Key\privatekey.pem -out Process\publickey.pem -outform PEM -pubout
                            
                            cd C:\HOST\PROCESS
                            del Author.csv
                            del Title.csv
                            del Genre.csv
                            del SubGenre.csv
                            del Height.csv
                            del Publisher.csv
                                
                            Move C:\Host\PROCESS\*.* \\CLIENT\Client\Encrypt\
                        </pre>
                    </div>
                     <div class='source-context-container'>
                        <div class='source-title'>2. Mã hóa pass đối xứng:</div>
                        <pre class='text-wrap'>

                            openssl pkeyutl -encrypt -inkey C:\Client\Key\publickey.pem -pubin 
                            -in pass.txt -out C:\Client\Encryption\pass.enc

                            del pass.txt
                            move C:\Client\Encryption\*.* \\Host\Host\Decryption\
                        </pre>
                    </div>
                    <div class='source-context-container'>
                        <div class='source-title'>3. Giải mã và xuất Query:</div>
                        <pre class='text-wrap'>
                            
                            @echo off
                            color c
                            
                            cd C:\Host\Process\
                            set /a pass=%RANDOM% * %RANDOM% * %RANDOM%
                            echo %pass%>>pass.txt
                            
                            cd C:\Program Files\7-Zip
                            7z a -p%pass% C:\Host\Process\DATA_OUT.zip C:\Host\Process\DATA_CLEAN.csv 
                            C:\Host\Process\Author.csv C:\Host\Process\Title.csv C:\Host\Process\Genre.csv 
                            C:\Host\Process\SubGenre.csv C:\Host\Process\Publisher.csv C:\Host\Process\Height.csv
                            
                            cd c:\Host\
                            openssl genrsa -out privatekey.pem 2048
                            openssl rsa -in Key\privatekey.pem -out Process\publickey.pem -outform PEM -pubout
                            
                            cd C:\HOST\PROCESS
                            del Author.csv
                            del Title.csv
                            del Genre.csv
                            del SubGenre.csv
                            del Height.csv
                            del Publisher.csv
                                
                            Move C:\Host\PROCESS\*.* \\CLIENT\Client\Encrypt\
                        </pre>
                    </div>
                </div>

                <script src='options\source-button.js'></script>
            </div>
        </div>
    </div>


    <script>    
        const ele = document.getElementById('nav')
        const title = document.getElementsByClassName('nav-title')
        window.addEventListener('scroll',(e) => {
            scrol = document.body.getBoundingClientRect().top;
            scrol < -20 ? ele.classList.add('active'):ele.classList.remove('active')
            scrol < -20 ? title[0].classList.add('active'):title[0].classList.remove('active')
           }
        )
    </script>

    <script src='options\direction.js'></script>
</body>
</html>